<html>
<head>
    <!--Load the AJAX API-->
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD25tIuhRbn7F9DIeb4hUCr6g-8eTq9NUI"></script>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <style>
        

    </style>
    <script type="text/javascript">

        function drawChart(marker) {

            // Create the data table.
            var data = new google.visualization.DataTable();
            data.addColumn('string', 'Race');
            data.addColumn('number', 'Population');
            data.addRows([
              ['White', 300],
              ['Black', 1000],
              ['Asian', 100],
              ['HISPANIC', 200],
              ['OTHER', 20]
            ]);

            // Set chart options
            var options = {
                'title': 'Pizza sold @ '  + 
                        marker.getPosition().toString(),
                'width': 450,
                'height': 250
            };

            var node = document.createElement('div'),
                infoWindow = new google.maps.InfoWindow(),
                chart = new google.visualization.PieChart(node);

            //node.style.borderColor = "red";
            //node.style.background = "blue";

            chart.draw(data, options);
            infoWindow.setContent(node);
            infoWindow.open(marker.getMap(), marker);
        }


        function initialize() {

            var mapOptions = {
                center: new google.maps.LatLng(-33.891044, 151.275537),
                zoom: 10,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };

            var map = new google.maps.Map(document.getElementById("map_canvas"),
                mapOptions);

            var marker1 = new google.maps.Marker({
                position: mapOptions.center,
                map: map
            });

            google.maps.event.addListener(marker1, 'click', function () {
                drawChart(this);
            });

        }
        //google.charts.load('visualization', '1.0', { 'packages': ['corechart'] });
        google.maps.event.addDomListener(window, 'load', initialize);
        google.charts.load('current', { 'packages': ['corechart'] });
    </script>
</head>

<body>
    <div id="map_canvas" style="height:800px;"></div>
</body>
</html>
